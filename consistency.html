<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Auto Report - Verify Certificate of Consistency Measurement</title>
  <!-- Reuse base styles; add consistency overrides -->
  <link rel="stylesheet" href="assets/ph/style.css" />
  <link rel="stylesheet" href="assets/consistency/custom.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@400;600;700&display=swap" rel="stylesheet">
  <script defer src="https://cdn.jsdelivr.net/npm/html2pdf.js@0.10.1/dist/html2pdf.bundle.min.js"></script>
  <script defer src="assets/config.js"></script>
  <script defer src="assets/consistency/cons.js"></script>
  <script defer src="assets/consistency/custom.js"></script>
  <script async defer src="https://accounts.google.com/gsi/client"></script>
  <meta name="color-scheme" content="light" />
  <meta name="theme-color" content="#0d6efd" />
  <link rel="manifest" href="manifest.webmanifest" />
  <link rel="apple-touch-icon" href="assets/logo_nps.svg" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <script defer src="assets/pwa.js"></script>
  <meta name="robots" content="noindex" />
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <style>
    .tcenter{ text-align:center }
    .tright{ text-align:right }
  </style>
  </head>
<body>
  <div id="app-view" class="app">
    <header class="app-header">
      <div class="brand">Auto Report</div>
      <div class="title">Verify Certificate of Consistency Measurement</div>
      <div class="actions">
        <a href="index.html"><button id="back-home" type="button" title="Back">Home</button></a>
        <button id="btn-load-demo" type="button">Load Demo</button>
        <button id="btn-save-json" type="button">Save JSON</button>
        <label class="import-json">
          <input id="input-load-json" type="file" accept="application/json" hidden />
          <span class="button-like">Import JSON</span>
        </label>
        <button id="btn-preview" type="button">Preview</button>
        <button id="btn-generate" class="primary" type="button">Save as PDF</button>
      </div>
    </header>

    <main class="layout single">
      <section class="panel form-panel">
        <h2>Form</h2>
        <form id="data-form">
          <div id="form-bar" class="form-bar">
            <div id="form-actions" class="form-actions"></div>
            <div class="form-tabs">
              <button type="button" data-jump="#doc-section">Document</button>
              <button type="button" data-jump="#xmtr-section">XMTR</button>
              <button type="button" data-jump="#func-section">Function Check</button>
              <button type="button" data-jump="#params-section">Parameters</button>
              <button type="button" data-jump="#sign-section">Sign</button>
              <button type="button" data-jump="#photos-section">Photos</button>
            </div>
          </div>

          <details open id="doc-section">
            <summary>Document Info</summary>
            <div class="grid g-3">
              <label>Certificate No.
                <input name="certificateNo" placeholder="e.g. AV/2025/0001" />
              </label>
              <label>Verify Date
                <input name="verifyDate" type="date" />
              </label>
            </div>
          </details>

          <details open id="xmtr-section">
            <summary>XMTR INFO</summary>
            <div class="grid g-3">
              <label>Tag No.
                <select name="tagNo"></select>
              </label>
              <label>Tag Name
                <input name="tagName" />
              </label>
              <label>Location
                <input name="location" />
              </label>
              <label>Maker
                <input name="maker" />
              </label>
              <label>Sensor Model
                <input name="sensorModel" />
              </label>
              <label>Sensor Serial No.
                <input name="sensorSerial" />
              </label>
              <label>Transmitter Model
                <input name="transmitterModel" />
              </label>
              <label>Transmitter Serial No.
                <input name="transmitterSerial" />
              </label>
              <label>Range (min)
                <input name="rangeMin" type="number" step="any" />
              </label>
              <label>Range (max)
                <input name="rangeMax" type="number" step="any" />
              </label>
              <label>Unit
                <input name="unit" value="%Cs" />
              </label>
              <div class="table-controls" style="grid-column:1 / -1; margin-top:6px">
                <button id="btn-update-tag" type="button">Update preset for this Tag</button>
              </div>
            </div>
          </details>

          <details open id="func-section">
            <summary>Function Check</summary>
            <div class="grid g-2">
              <div>
                <table class="mini">
                  <thead>
                    <tr><th>Description</th><th>Status</th><th>Complete</th></tr></thead>
                  <tbody>
                    <tr id="fcL-0"><td>Remove</td><td class="tcenter"><input type="checkbox" class="flag" name="status" /></td><td class="tcenter"><input type="checkbox" class="flag" name="complete" /></td></tr>
                    <tr id="fcL-1"><td>Install</td><td class="tcenter"><input type="checkbox" class="flag" name="status" /></td><td class="tcenter"><input type="checkbox" class="flag" name="complete" /></td></tr>
                    <tr id="fcL-2"><td>Supply</td><td class="tcenter"><input type="checkbox" class="flag" name="status" /></td><td class="tcenter"><input type="checkbox" class="flag" name="complete" /></td></tr>
                    <tr id="fcL-3"><td>Cable connector</td><td class="tcenter"><input type="checkbox" class="flag" name="status" /></td><td class="tcenter"><input type="checkbox" class="flag" name="complete" /></td></tr>
                  </tbody>
                </table>
              </div>
              <div>
                <table class="mini">
                  <thead>
                    <tr><th>Description</th><th>Status</th><th>Complete</th></tr></thead>
                  <tbody>
                    <tr id="fcR-0"><td>Support (Sensor&amp;Tx.)</td><td class="tcenter"><input type="checkbox" class="flag" name="status" /></td><td class="tcenter"><input type="checkbox" class="flag" name="complete" /></td></tr>
                    <tr id="fcR-1"><td>Cover (Sensor&amp;Tx.)</td><td class="tcenter"><input type="checkbox" class="flag" name="status" /></td><td class="tcenter"><input type="checkbox" class="flag" name="complete" /></td></tr>
                    <tr id="fcR-2"><td>Terminal cable (Sensor&amp;Tx.)</td><td class="tcenter"><input type="checkbox" class="flag" name="status" /></td><td class="tcenter"><input type="checkbox" class="flag" name="complete" /></td></tr>
                    <tr id="fcR-3"><td>Test Sensor</td><td class="tcenter"><input type="checkbox" class="flag" name="status" /></td><td class="tcenter"><input type="checkbox" class="flag" name="complete" /></td></tr>
                  </tbody>
                </table>
              </div>
            </div>
          </details>

          <details open id="params-section">
            <summary>Parameters</summary>
            <div class="mt-6">
              <label>Parameter Template
                <select name="paramTemplate" id="param-template-select">
                  <option value="standard">Standard ST</option>
                  <option value="rotary">Rotary</option>
                  <option value="hlss">HLSS</option>
                  <option value="blade">Blade RL</option>
                  <option value="blade_generic">Blade</option>
                  <option value="blade_st">Blade ST</option>
                  <option value="blade_jl">Blade JL</option>
                  <option value="blade_md">Blade MD</option>
                </select>
              </label>
            </div>
            <div class="grid g-2">
              <div>
                <table class="mini">
                  <thead><tr><th>Description</th><th>Value</th><th>Unit</th></tr></thead>
                  <tbody id="params-left-body"></tbody>
                </table>
              </div>
              <div>
                <table class="mini">
                  <thead><tr><th>Description</th><th>Value</th></tr></thead>
                  <tbody id="params-right-body"></tbody>
                </table>
              </div>
            </div>
          </details>

          <details open id="sign-section">
            <summary>Signers</summary>
            <div class="grid g-3">
              <label>Verified by <span id="tech-role-inline" class="hint"></span>
                <select name="technician" id="technician-select"></select>
              </label>
              <label>Approved by (Engineer)
                <select name="approver" id="approver-select"></select>
              </label>
              <label>Sign Date
                <input name="signDate" type="date" />
              </label>
            </div>
            <label class="block">Remarks
              <textarea name="remarks" rows="3"></textarea>
            </label>
          </details>

          <details open id="photos-section">
            <summary>Photos (3)</summary>
            <div class="grid g-3">
              <label>Photo 1
                <input type="file" name="photo1" accept="image/*" />
                <img id="thumb-photo1" class="thumb-preview" alt="preview1" style="display:none" />
              </label>
              <label>Photo 2
                <input type="file" name="photo2" accept="image/*" />
                <img id="thumb-photo2" class="thumb-preview" alt="preview2" style="display:none" />
              </label>
              <label>Photo 3
                <input type="file" name="photo3" accept="image/*" />
                <img id="thumb-photo3" class="thumb-preview" alt="preview3" style="display:none" />
              </label>
            </div>
          </details>
        </form>
      </section>

      <section class="panel preview-panel hidden">
        <h2>Preview</h2>
        <div id="certificate" class="cert paper">
          <div class="cert-header">
            <div class="logo" id="logo-box"><img src="assets/logo_nps.svg" alt="logo" style="width:100%;height:100%;object-fit:contain;display:block;"/></div>
            <div class="cert-title">Verify Certificate<br>of Consistency Measurement</div>
            <div class="cert-sub">
              <span>Certificate no.: <span data-bind="certificateNo"></span></span>
              <span>Verify date: <span data-bind="verifyDate"></span></span>
            </div>
          </div>

          <section class="block">
            <div class="block-title">XMTR INFO</div>
            <table class="kv">
              <colgroup>
                <col class="kv-th"><col class="kv-td"><col class="kv-th"><col class="kv-td">
              </colgroup>
              <tbody>
                <tr>
                  <th>Tag No.</th><td data-bind="tagNo"></td>
                  <th>Tag Name</th><td data-bind="tagName"></td>
                </tr>
                <tr>
                  <th>Location</th><td data-bind="location"></td>
                  <th>Maker</th><td data-bind="maker"></td>
                </tr>
                <tr>
                  <th>Sensor Model</th><td data-bind="sensorModel"></td>
                  <th>Serial No.</th><td data-bind="sensorSerial"></td>
                </tr>
                <tr>
                  <th>Transmitter Model</th><td data-bind="transmitterModel"></td>
                  <th>Serial No.</th><td data-bind="transmitterSerial"></td>
                </tr>
                <tr>
                  <th>Range</th><td><span data-bind="rangeMin"></span> - <span data-bind="rangeMax"></span> <span data-bind="unit"></span></td>
                  <th></th><td></td>
                </tr>
              </tbody>
            </table>
          </section>

          <section class="block" id="function-check">
            <div class="block-title">Function Check</div>
            <div class="grid g-2">
              <table class="funcchk">
                <colgroup>
                  <col style="width:44%"><col style="width:14%"><col style="width:14%"><col style="width:14%"><col style="width:14%">
                </colgroup>
                <thead>
                  <tr class="hdr1"><th rowspan="2">Description</th><th colspan="2">Status</th><th colspan="2">Complete</th></tr>
                  <tr class="hdr2"><th>YES</th><th>NO</th><th>YES</th><th>NO</th></tr>
                </thead>
                <tbody id="fc-left"></tbody>
              </table>
              <table class="funcchk">
                <colgroup>
                  <col style="width:44%"><col style="width:14%"><col style="width:14%"><col style="width:14%"><col style="width:14%">
                </colgroup>
                <thead>
                  <tr class="hdr1"><th rowspan="2">Description</th><th colspan="2">Status</th><th colspan="2">Complete</th></tr>
                  <tr class="hdr2"><th>YES</th><th>NO</th><th>YES</th><th>NO</th></tr>
                </thead>
                <tbody id="fc-right"></tbody>
              </table>
            </div>
          </section>

          <section class="block">
            <div class="block-title">Parameters</div>
              <div class="grid g-2">
                <table class="tgrid">
                  <colgroup>
                    <col style="width:44%"><col style="width:28%"><col style="width:28%">
                  </colgroup>
                  <thead><tr><th>Description</th><th>Value</th><th>Unit</th></tr></thead>
                  <tbody id="params-left"></tbody>
                </table>
                <table class="tgrid">
                  <colgroup>
                    <col style="width:44%"><col style="width:56%">
                  </colgroup>
                  <thead><tr><th>Description</th><th>Value</th></tr></thead>
                  <tbody id="params-right"></tbody>
                </table>
              </div>
          </section>

          <section class="block" id="photos-block">
            <div class="block-title">Photos</div>
            <div class="photos">
              <img id="img1" alt="photo1" />
              <img id="img2" alt="photo2" />
              <img id="img3" alt="photo3" />
            </div>
          </section>

          <section class="block" id="end-of-verify">
            <div class="block-title">End of Verify</div>
            <table class="kv">
              <colgroup>
                <col class="kv-th"><col class="kv-td"><col class="kv-th"><col class="kv-td">
              </colgroup>
              <tbody>
                <tr>
                  <th>Verify by</th><td><span data-bind="technician"></span><div class="hint" data-bind="technicianPosition">Technician</div></td>
                  <th>Approved by</th><td><span data-bind="approver"></span><div class="hint">Engineer</div></td>
                </tr>
                <tr>
                  <th>Date</th><td data-bind="signDate"></td>
                  <th>Remarks</th><td data-bind="remarks"></td>
                </tr>
              </tbody>
            </table>
          </section>
        </div>
      </section>
    </main>

    <footer class="app-footer">
      <span>Auto Report (Local HTML) • Export PDF offline</span>
    </footer>
  </div>

  <div id="mobile-cta" class="mobile-cta">
    <a href="index.html"><button id="cta-home" type="button" class="ghost icon" title="Home" aria-label="Home"><i class="fa-solid fa-house"></i></button></a>
    <button id="cta-preview" type="button" class="ghost icon" title="Preview" aria-label="Preview"><i class="fa-solid fa-eye"></i></button>
    <button id="cta-save" type="button" class="primary icon" title="Save as PDF" aria-label="Save as PDF"><i class="fa-solid fa-download"></i></button>
  </div>

  <div id="preview-modal" class="modal hidden" aria-hidden="true" role="dialog" aria-label="Preview">
    <div class="modal-backdrop" data-close></div>
    <div class="modal-dialog">
      <header class="modal-head">
        <div class="mh-title">Preview</div>
        <button id="preview-close" class="modal-close" type="button" aria-label="Close">Close</button>
      </header>
      <div class="modal-body">
        <div id="preview-mount"></div>
      </div>
      <footer class="modal-foot">
        <button id="preview-close-2" type="button">Close</button>
      </footer>
    </div>
  </div>
</body>
</html>
